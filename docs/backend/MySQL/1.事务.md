---
title: MySQL 事务
description: MySQL 事务学习笔记
---
# MySQL事务
## 事务特性
### 原子性（Atomicity）
事物的整个过程如原子操作一样，最终要么全部成功，或者全部失败，这个原子性是从最终结果来看的，从最终结果来看这个过程是不可分割的。
### 一致性（Consistency）
一个事物必须使数据库从一个一致状态转换到另一个一致状态。
### 隔离性（Isolatoin）
一个事物的执行不能被其他事务干扰。即一个事物内部的操作及使用的数据对并发的其他事物是隔离的，并发执行的各个事务之间不能互相干扰。
#### 事务隔离级别
- 读未提交：read uncommitted
    
    在读未提交隔离级别下，事务可以读取到其他事务未提交的数据。这种隔离级别可能会导致脏读、不可重复读和幻度的问题。脏读是指一个事务读取了另一个事务未提交的数据，而这些数据可能会被回滚，从而导致读取到的数据不一致。
- 读已提交：read committed

    在读已提交隔离级别下，事务值能读取到其他事务已经提交的数据，从而避免了脏读问题。然而，不可重复读和幻读问题仍然可能发生。不可重复读是指一个事务中多次读取同一个数据时，结果可能不同，因为其他事务可能在此期间修改了数据。
- 可重复读：repeatable read

    可重复读是MySQL InnoDB存储引擎的默认隔离级别。在这种隔离级别下，同一事物的多次读取结果是一致的，除非数据被该事务本身修改，可重复读可以防止脏读和不可重复读，但幻读问题仍然可能发生。InnoDB通过使用MCVV（多版本并发控制）和Next-Key Lock（行锁和间隙锁的结合）来解决幻读问题。
- 串行化：serializable

    串行化是最高的隔离级别，完全遵循ACID的隔离性要求。在这种隔离级别下，所有事物依次逐个执行，完全避免了脏读、不可重复读和幻读问题。然而，串行化隔离级别的并发性能较低，通常只在特殊情况下使用。
### 持久行（Durability）
一个事务一旦提交，他对数据库中的数据的改变就应该是永久性的。当事务提交后，数据持久化到硬盘，修改是永久性的。
## 隐式事务
事务自动开启、提交或回滚，比如insert、update、delete语句，事务的开启、提交或回滚由mysql内部自动控制。
产看变量autocommit是否开启了自动提交
```sql
show variables like 'autocommit';
```
### 显式事务
事务需要手动开启、提交或关闭，由开发者自己控制。
```sql
set autocommit=0;|begin;|start transaction;
commit|rollblack;
```
### 脏读
### 可重复读
### 不可重复读
### 幻读
### MVCC